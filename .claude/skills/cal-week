#!/usr/bin/env python3
"""
Calendar Week Skill

Show this week's calendar events.

Usage:
  /cal-week
  /cal-week --next-week
  /cal-week --detailed

Calls the CC agent to get calendar from Google Calendar.
"""

import sys
import subprocess
from pathlib import Path


AGENTS_DIR = Path(__file__).resolve().parent.parent.parent

def main():
    """Show week's calendar"""

    print("üìÖ Week's Calendar\n")
    print("=" * 70)

    # Determine which week
    if "--next-week" in sys.argv:
        message = "Show me next week's calendar events"
    elif "--detailed" in sys.argv:
        message = "Show me this week's calendar with full details for each event"
    else:
        message = "Show me this week's calendar events"

    # Run the CC agent
    try:
        result = subprocess.run(
            [
                "python", "-m", "agency", "debug", "test", "cc",
                "--message", message
            ],
            cwd=str(AGENTS_DIR),
            capture_output=False,
            text=True
        )

        return result.returncode

    except Exception as e:
        print(f"‚ùå Error getting calendar: {e}")
        return 1


if __name__ == "__main__":
    sys.exit(main())
